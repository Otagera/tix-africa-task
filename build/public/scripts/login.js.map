{"version":3,"file":"login.js","sourceRoot":"","sources":["../../../src/public/scripts/login.ts"],"names":[],"mappings":"AAMA;IAAA;QAAA,iBAgDC;QA9CA,SAAI,GAAY,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QACtD,kBAAa,GAAuC,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;QAC9F,kBAAa,GAAuC,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;QAE9F,iBAAY,GAAG;YACd,KAAI,CAAC,SAAS,GAAG;gBAChB,QAAQ,EAAE,KAAI,CAAC,aAAa,CAAC,KAAK;gBAClC,QAAQ,EAAE,KAAI,CAAC,aAAa,CAAC,KAAK;aAClC,CAAC;QACH,CAAC,CAAA;QACD,SAAI,GAAG;YACN,KAAI,CAAC,IAAI,IAAI,KAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,UAAC,CAAC;gBACnD,CAAC,CAAC,cAAc,EAAE,CAAC;gBACnB,IAAG,KAAI,CAAC,aAAa,IAAI,KAAI,CAAC,aAAa,CAAC,KAAK,IAAI,KAAI,CAAC,aAAa,IAAI,KAAI,CAAC,aAAa,CAAC,KAAK,EAAC;oBACnG,KAAI,CAAC,YAAY,EAAE,CAAC;oBACpB,KAAI,CAAC,YAAY,EAAE,CAAC;iBACpB;YACF,CAAC,CAAC,CAAC;QACJ,CAAC,CAAA;QACD,iBAAY,GAAG;YACd,CAAC,CAAC,IAAI,CAAC,aAAa,EAAE,KAAI,CAAC,SAAS,CAAC;iBACnC,IAAI,CAAC,UAAA,QAAQ;gBACd,IAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAC;oBACtB,IAAM,IAAI,GAAgB;wBACzB,KAAK,EAAE,QAAQ,CAAC,IAAI,CAAC,KAAK;wBAC1B,QAAQ,EAAE,QAAQ,CAAC,IAAI,CAAC,QAAQ;qBAChC,CAAA;oBACD,YAAY,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;oBACvD,KAAI,CAAC,aAAa,CAAC,KAAK,GAAG,EAAE,CAAC;oBAC9B,KAAI,CAAC,aAAa,CAAC,KAAK,GAAG,EAAE,CAAC;oBAC9B,KAAI,CAAC,YAAY,EAAE,CAAC;iBACpB;YACD,CAAC,CAAC,CAAC,IAAI,CAAC,UAAA,GAAG;gBACV,IAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBACtD,WAAW,CAAC,YAAY,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;gBAC3C,WAAW,CAAC,YAAY,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;gBACpD,WAAW,CAAC,YAAY,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC;gBAC3D,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;gBACvC,WAAW,CAAC,KAAK,EAAE,CAAC;gBACpB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;gBACtC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAClB,CAAC,CAAC,CAAC;QACL,CAAC,CAAA;QACD,iBAAY,GAAG;YACd,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,CAAC;QAC5B,CAAC,CAAA;IACF,CAAC;IAAD,YAAC;AAAD,CAAC,AAhDD,IAgDC;AAED,IAAM,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;AAC1B,KAAK,CAAC,IAAI,EAAE,CAAC","sourcesContent":["\r\ninterface StorageUser {\r\n\tusername: string;\r\n\ttoken: string;\r\n}\r\n\r\nclass Login {\r\n\tloginData: { [key: string]: string };\r\n\tform: Element = document.querySelector('#login-form');\r\n\tusernameInput: HTMLInputElement = <HTMLInputElement>document.querySelector('#login-username');\r\n\tpasswordInput: HTMLInputElement = <HTMLInputElement>document.querySelector('#login-password');\r\n\r\n\tgetLoginData = (): void =>{\r\n\t\tthis.loginData = {\r\n\t\t\tusername: this.usernameInput.value,\r\n\t\t\tpassword: this.passwordInput.value\r\n\t\t};\r\n\t}\r\n\tinit = (): void =>{\r\n\t\tthis.form && this.form.addEventListener('submit', (e)=>{\r\n\t\t\te.preventDefault();\r\n\t\t\tif(this.usernameInput && this.usernameInput.value && this.passwordInput && this.passwordInput.value){\r\n\t\t\t\tthis.getLoginData();\r\n\t\t\t\tthis.loginRequest();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tloginRequest = (): void=>{\r\n\t\t$.post('/auth/login', this.loginData)\r\n\t\t .done(response=>{\r\n\t\t\tif(response.data.token){\r\n\t\t\t\tconst user: StorageUser = {\r\n\t\t\t\t\ttoken: response.data.token,\r\n\t\t\t\t\tusername: response.data.username\r\n\t\t\t\t}\r\n\t\t\t\tlocalStorage.setItem('tix-user', JSON.stringify(user));\r\n\t\t\t\tthis.usernameInput.value = '';\r\n\t\t\t\tthis.passwordInput.value = '';\r\n\t\t\t\tthis.getIndexPage();\r\n\t\t\t}\r\n\t\t }).fail(err=>{\r\n\t\t \tconst addModalBtn = document.createElement('button');\r\n\t\t\taddModalBtn.setAttribute('type', 'button');\r\n\t\t\taddModalBtn.setAttribute('data-bs-toggle', 'modal');\r\n\t\t\taddModalBtn.setAttribute('data-bs-target', '#login-error');\r\n\t\t\tdocument.body.appendChild(addModalBtn);\r\n\t\t\taddModalBtn.click();\r\n\t\t\tdocument.body.removeChild(addModalBtn);\r\n\t\t \tconsole.log(err);\r\n\t\t });\r\n\t}\r\n\tgetIndexPage = (): void =>{\r\n\t\twindow.location.href = '/';\r\n\t}\r\n}\r\n\r\nconst login = new Login();\r\nlogin.init();\r\n"]}
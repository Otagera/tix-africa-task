{"version":3,"file":"clearUploadsFolder.js","sourceRoot":"","sources":["../../src/middlewares/clearUploadsFolder.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AACA,0CAAoB;AACpB,8CAAwB;AAExB,IAAM,SAAS,GAAG,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;AAEjD,IAAM,YAAY,GAAG,UAAC,GAAY,EAAE,GAAa,EAAE,IAAkB;IAC3E,IAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAC;QACxC,IAAI,EAAE,CAAC;KACP;SAAI;QACJ,YAAE,CAAC,OAAO,CAAC,SAAS,EAAE,UAAC,GAAG,EAAE,KAAK;;YAChC,IAAG,GAAG;gBAAE,MAAM,GAAG,CAAC;;gBAClB,KAAkB,IAAA,UAAA,SAAA,KAAK,CAAA,4BAAA,+CAAC;oBAApB,IAAM,IAAI,kBAAA;oBACb,YAAE,CAAC,MAAM,CAAC,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,EAAE,UAAA,GAAG;wBACxC,IAAG,GAAG;4BAAE,MAAM,GAAG,CAAC;oBACnB,CAAC,CAAC,CAAC;iBACH;;;;;;;;;QACF,CAAC,CAAC,CAAC;QACH,IAAI,EAAE,CAAC;KACP;AACF,CAAC,CAAA;AAdY,QAAA,YAAY,gBAcxB","sourcesContent":["import { Request, Response, NextFunction } from 'express';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst directory = path.join(__dirname, '../../uploads');\r\n\r\nexport const clearUploads = (req: Request, res: Response, next: NextFunction)=>{\r\n\tif(process.env.NODE_ENV === 'production'){\r\n\t\tnext();\r\n\t}else{\r\n\t\tfs.readdir(directory, (err, files)=>{\r\n\t\t\tif(err) throw err;\r\n\t\t\tfor(const file of files){\r\n\t\t\t\tfs.unlink(path.join(directory, file), err=>{\r\n\t\t\t\t\tif(err) throw err;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tnext();\r\n\t}\r\n}"]}